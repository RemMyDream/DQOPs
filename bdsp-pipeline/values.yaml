# Default values for bdsp-pipeline

# Namespace configuration
namespace: dqops

# PostgreSQL configuration
postgres:
  enabled: true
  image:
    repository: postgres
    tag: "15"
    pullPolicy: IfNotPresent
  
  service:
    type: ClusterIP
    port: 5432
  
  persistence:
    enabled: true
    size: 10Gi
    storageClass: ""
    accessMode: ReadWriteOnce
  
  config:
    user: postgres
    password: postgres
    database: sourcedb
  
  resources:
    requests:
      memory: "256Mi"
      cpu: "100m"
    limits:
      memory: "1Gi"
      cpu: "500m"
  
  livenessProbe:
    enabled: true
    initialDelaySeconds: 30
    periodSeconds: 10
  
  readinessProbe:
    enabled: true
    initialDelaySeconds: 5
    periodSeconds: 5

# MinIO configuration
minio:
  enabled: true
  image:
    repository: minio/minio
    tag: latest
    pullPolicy: IfNotPresent
  
  mcImage:
    repository: minio/mc
    tag: latest
  
  service:
    type: ClusterIP
    apiPort: 9000
    consolePort: 9001
  
  persistence:
    enabled: true
    size: 20Gi
    storageClass: ""
    accessMode: ReadWriteOnce
  
  config:
    rootUser: admin
    rootPassword: password
  
  buckets:
    - bronze
    - silver
    - gold
  
  resources:
    requests:
      memory: "256Mi"
      cpu: "100m"
    limits:
      memory: "1Gi"
      cpu: "500m"
  
  livenessProbe:
    enabled: true
    initialDelaySeconds: 30
    periodSeconds: 20
  
  readinessProbe:
    enabled: true
    initialDelaySeconds: 10
    periodSeconds: 10

# Spark configuration
spark:
  enabled: true
  
  master:
    image:
      repository: apache/spark
      tag: "3.5.3"
      pullPolicy: IfNotPresent
    
    replicas: 1
    
    service:
      type: ClusterIP
      sparkPort: 7077
      webuiPort: 8080
      appUIPort: 4040
    
    env:
      sparkMode: master
      sparkMasterHost: "0.0.0.0"
      sparkMasterPort: "7077"
      sparkMasterWebuiPort: "8080"
    
    resources:
      requests:
        memory: "1Gi"
        cpu: "200m"
      limits:
        memory: "2Gi"
        cpu: "1000m"
  
  worker:
    image:
      repository: apache/spark
      tag: "3.5.3"
      pullPolicy: IfNotPresent
    
    replicas: 2
    
    env:
      sparkMode: worker
      sparkWorkerCores: "2"
      sparkWorkerMemory: "2g"
      sparkWorkerWebuiPort: "8081"
    
    resources:
      requests:
        memory: "1Gi"
        cpu: "500m"
      limits:
        memory: "4Gi"
        cpu: "2000m"

# Elasticsearch configuration
elasticsearch:
  enabled: true
  image:
    repository: docker.elastic.co/elasticsearch/elasticsearch
    tag: "8.11.4"
    pullPolicy: IfNotPresent
  
  service:
    type: ClusterIP
    httpPort: 9200
    transportPort: 9300
  
  persistence:
    enabled: true
    size: 10Gi
    storageClass: ""
    accessMode: ReadWriteOnce
  
  config:
    discoveryType: single-node
    javaOpts: "-Xms1024m -Xmx1024m"
    xpackSecurityEnabled: "false"
  
  securityContext:
    fsGroup: 1000
    runAsUser: 1000
    runAsNonRoot: true
  
  resources:
    requests:
      memory: "1Gi"
      cpu: "200m"
    limits:
      memory: "2Gi"
      cpu: "1000m"
  
  livenessProbe:
    enabled: true
    initialDelaySeconds: 60
    periodSeconds: 15
    timeoutSeconds: 10
  
  readinessProbe:
    enabled: true
    initialDelaySeconds: 30
    periodSeconds: 15
    timeoutSeconds: 10

# PostgreSQL Metadata (for OpenMetadata)
postgresMetadata:
  enabled: false
  image:
    repository: postgres
    tag: "15"
    pullPolicy: IfNotPresent
  
  service:
    type: ClusterIP
    port: 5432
  
  persistence:
    enabled: true
    size: 5Gi
    storageClass: ""
    accessMode: ReadWriteOnce
  
  config:
    user: openmetadata_user
    password: openmetadata_password
    database: openmetadata_db

# Global settings
global:
  storageClass: ""
  
# Additional labels to add to all resources
commonLabels: {}

# Additional annotations to add to all resources
commonAnnotations: {}
